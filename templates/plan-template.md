# [功能名称] - 技术实现方案

> 对应规格：`specs/{module}/spec.md`

---

## 1. 技术选型

> 每个选型必须说明理由，理由需对应 spec 中的具体需求或约束。
> 如果是迁移/重构类任务，使用"旧 → 新"对比格式。

| 组件 | 选型 | 理由 |
|------|------|------|
| [组件] | [技术/库/工具] | [对应 spec 中哪个需求或约束] |

---

## 2. 模块设计

> 列出需要新增或修改的模块。不涉及变更的模块无需列出。

| 模块 | 变更类型 | 变更内容 |
|------|---------|---------|
| [模块名] | 新增 / 修改 / 完全重写 / 不变 | [具体变更说明] |

### 2.x [模块名]

**职责**：[一句话说明]

**接口设计**（公开方法）：
```
[方法签名] -> [返回类型]  # [用途]
[方法签名] -> [返回类型]  # [用途]
```

**纯函数**（单元测试目标）：
```
[函数签名] -> [返回类型]  # [用途]
```

> 每个需要详细设计的模块重复此节。不复杂的模块只需在模块矩阵中说明即可。

---

## 3. 关键流程

> 只描述有技术复杂度的流程，业务流程已在 spec.md 中说明过的不重复。
> 重点说明：组件间如何协作、数据如何流转、异常如何处理。

### 3.x [流程名称]

[文字描述或伪代码，说明关键步骤和异常处理路径]

---

## 4. 测试策略

> 按照 constitution.md 的测试层次说明每层测试的覆盖范围和约束。

| 层次 | 覆盖范围 | 约束 |
|------|---------|------|
| 单元测试 | [纯函数、命令生成等不涉及 I/O 的逻辑] | 禁止 Mock |
| 集成测试 | [模块间协作、真实 I/O 操作] | 可 Mock 外部依赖，每类最多 3 个方法 |
| E2E 测试 | [完整业务流程] | 禁止 Mock，使用真实环境 |

---

## 5. 风险

> 只列真实存在的风险，不填凑数的通用风险。

| 风险 | 影响 | 缓解措施 |
|------|------|---------|
| [具体风险] | 高 / 中 / 低 | [具体措施] |

---

## 6. 依赖清单

### 新增依赖
```
[包名/工具名] — [用途]
```

### 移除依赖
```
[包名/工具名] — [移除原因]
```

---

## 7. 合宪性审查

> 对照 constitution.md 的核心原则自查。

| 原则 | 符合性 | 说明 |
|------|--------|------|
| 简单性 | ✅ / ⚠️ / ❌ | [说明] |
| 测试先行 | ✅ / ⚠️ / ❌ | [说明] |
| 单一职责 | ✅ / ⚠️ / ❌ | [说明] |
| [其他原则] | ✅ / ⚠️ / ❌ | [说明] |